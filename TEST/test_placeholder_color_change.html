<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ネスト対応Vue.js</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
    <style>
        .placeholder {
            color: blue;
            font-weight: bold;
        }
    </style>
</head>

<body>
    <div id="app">
        <!-- 言語選択 -->
        <label for="language-select">言語を選択:</label>
        <select id="language-select" v-model="selectedLanguage">
            <option value="ja">日本語</option>
            <option value="en">English</option>
        </select>

        <!-- 結果表示 -->
        <p v-html="styledTranslate('これは{{rights.name}}さんが作成した利用規約です。')"></p>
    </div>

    <script>
        const app = new Vue({
            el: '#app',
            data: {
                selectedLanguage: 'ja',
                translations: {
                    'これは{{rights.name}}さんが作成した利用規約です。': {
                        en: 'This is the license agreement created by {{rights.name}}.',
                        ja: 'これは{{rights.name}}さんが作成した利用規約です。'
                    }
                },
                placeholders: {
                    rights: {
                        name: '山田太郎', // ネストされたプレースホルダー
                        email: 'yamada@example.com'
                    }
                }
            },
            methods: {
                resolvePlaceholders(template) {
                    // ネストされたオブジェクトから値を取得
                    const getNestedValue = (obj, path) => {
                        return path.split('.').reduce((acc, key) => acc && acc[key], obj);
                    };

                    // プレースホルダーを解決しつつスタイリング
                    return template.replace(/{{(.*?)}}/g, (_, path) => {
                        const value = getNestedValue(this.placeholders, path.trim());
                        return value !== undefined
                            ? `<span class="placeholder">${value}</span>`
                            : `{{${path}}}`; // 未解決のプレースホルダーはそのまま
                    });
                },
                styledTranslate(japaneseText) {
                    const translation = this.translations[japaneseText];
                    const template = translation && translation[this.selectedLanguage]
                        ? translation[this.selectedLanguage]
                        : japaneseText;

                    return this.resolvePlaceholders(template);
                }
            }
        });
    </script>
</body>

</html>