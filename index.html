<!doctype html>
<html lang="ja">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=900px,initial-scale=1.0">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
        integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">

    <title>VN3License Easy Generator</title>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-18343253-8"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-18343253-8');
    </script>


    <script src="https://code.jquery.com/jquery-3.3.1.min.js" type="text/javascript"></script>
    
    <script src="lc_switch.js" type="text/javascript"></script>
    <script src="main.js" type="text/javascript"></script>
    
    <link rel="stylesheet" href="lc_switch.css">
    <link rel="stylesheet" href="main.css">
</head>

<body>
    <div class="content" id="header">
        <h1>VN3License Easy Generator</h1>
    </div>
    <div class="content" id="mainmenu">
                <div class="menu-left"><a href="https://www.vn3.org/icons" target="_blank">ã‚¢ã‚¤ã‚³ãƒ³ãƒ‡ãƒ¼ã‚¿</a></div>
                <div class="menu-left"><a href="https://www.vn3.org/terms" target="_blank">æœ¬æ–‡ãƒ»è§£èª¬</a></div>
                <div class="menu-left"><a href="https://www.vn3-portal.org/" target="_blank">VN3Licenseãƒãƒ¼ã‚¿ãƒ«ã‚µã‚¤ãƒˆ</a></div>
                <!-- <div class="menu-right"><a href="https://www.vn3.org/" target="_blank">VN3Licenseå…¬å¼</a></div> -->
    </div>

    <div class="content" id="menu">
        <div id="settingbutton"><span style="vertical-align:bottom;font-weight: bold;">ç”»åƒãƒ‘ãƒãƒ«è¨­å®š </span><img src="settings.png" width="40px" height="40px"></div>
        <div id="setting">
            <p>
                <input type="checkbox" id="setting-pin" checked="checked"><label for="setting-pin" style="user-select: none;">ğŸ“Œãƒ”ãƒ³ã©ã‚</label>
            </p>
            <hr>
            <p>
            <div class="settingtext">ç”»åƒå¹…</div><input id="imagewidthslider" type="range" value="440" min="440" max="1800"
                step="1">
            <span id="imagewidth">440</span>
            </p>
            <p>
            <div class="settingtext">ã‚«ãƒ©ãƒ æ•°</div><input id="columnslider" type="range" value="6" min="2" max="24" step="1">
            <span id="columnnum">6</span>
            </p>
        </div>
    </div>
    <div class="content" id="overview">
        <p>
            <a href="https://www.vn3.org/">VN3ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</a>ã¯VN3ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒãƒ¼ãƒ  2020ã«ã‚ˆã£ã¦ä½œã‚‰ã‚ŒãŸãƒãƒ¼ãƒãƒ£ãƒ«ãƒã‚¤ãƒ†ã‚£ãƒ–ã®ç”Ÿæ´»ã‚„ãƒãƒ¼ãƒãƒ£ãƒ«æ–‡åŒ–ã€ãã—ã¦VRã®ç™ºå±•ã«å¯„ä¸ã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ãŸã€æ±ç”¨çš„ãªãƒ‡ãƒ¼ã‚¿é…å¸ƒç”¨ã®åˆ©ç”¨è¦ç´„ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§ã™ã€‚
        </p>
        <p>
            ã“ã®ãƒšãƒ¼ã‚¸ã§ã¯VN3License<span id="vn3licenseversion"></span>ã«æº–æ‹ ã—ãŸåˆ©ç”¨è¨±è«¾ç”»åƒã¨è¦ç´„ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚ˆã‚Šç°¡å˜ã«ç”Ÿæˆãƒ»ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ã§ã™ã€‚
        </p>
        <p>
            <span style="color:red">åˆ©ç”¨ã™ã‚‹å ´åˆã¯ã€ã”è‡ªèº«ã®è²¬ä»»ã§ã”åˆ©ç”¨ãã ã•ã„ã€‚VN3ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãŠã‚ˆã³EasyGeneratorè£½ä½œè€…ã¯ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®æ³•çš„è²¬ä»»ã¯è² ã‚ãªã„ã‚‚ã®ã¨ã—ã¾ã™ã€‚</span><br>
            çµ±è¨ˆæƒ…å ±ã¨ã—ã¦åˆ©ç”¨ã™ã‚‹ç›®çš„ã§A.ï½X.é …ç›®ã‚’ã‚µãƒ¼ãƒãƒ¼ã«ä¿å­˜ã—ã¦ã„ã¾ã™ï¼ˆè‡ªç”±è¨˜å…¥æ¬„ã®å€‹äººæƒ…å ±ãªã©ã¯å–å¾—ã—ã¦ã„ã¾ã›ã‚“ï¼‰<br>
        </p>
        <p>
            ã“ã®Easy Generatorã«ã¤ã„ã¦ã®ãŠå•ã„åˆã‚ã›ã¯<a href="https://twitter.com/lowteq_vr">@lowteq_vr</a>ã¾ã§ãŠé¡˜ã„ã—ã¾ã™ã€‚
        </p>
    </div>
    <div class="content" id="maincontents">  
    </div>
    <hr style="width:900px">
    <div class="content" id="downloadtextpanel">
        <div id="textsettingpanel">
            <b>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›é …ç›®</b>
            <form action="" id="textform">
            <p>
                <div class="settingtext">åˆ©ç”¨è¦ç´„ã‚¿ã‚¤ãƒˆãƒ«<span class="reqtext">*</span></div><input type="text" class="dtp-value" id="dtp-title" required>
            </p>
            <p>
                <div class="settingtext">æ¨©åˆ©è€…å<span class="reqtext">*</span></div><input type="text" class="dtp-value" id="dtp-author_name" required>
            </p>
            <p>
                <div class="settingtext">è¨±è«¾å¯¾è±¡ãƒ‡ãƒ¼ã‚¿å<span class="reqtext">*</span></div><input type="text" class="dtp-value" id="dtp-data_name" required>
            </p>
            <p>
                <div class="settingtext">ç‰¹è¨˜äº‹é …</div><input type="text" class="dtp-value" id="dtp-special_notes">
            </p>
            <p>
                <div class="settingtext">æ¨©åˆ©è€…å•ã„åˆã‚ã›å…ˆ</div><input type="text" class="dtp-value" id="dtp-author_reference">
            </p>
            <p>
                <div class="settingtext">ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆ</div><input type="text" class="dtp-value" id="dtp-author_website">
            </p>
            <p>
                <div class="settingtext">ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆè¡¨è¨˜</div><input type="text" class="dtp-value" id="dtp-credit">
            </p>
            <p>
                <div class="settingtext">æ¨å¥¨ã™ã‚‹ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°</div><input type="text" class="dtp-value" id="dtp-hashtag">
            </p>
            <p>
                <div class="settingtext">è¨±è«¾æœŸé–“ãŠã‚ˆã³<br>è¨±è«¾ã®å¤‰æ›´ç­‰<span class="reqtext">*</span></div>
                <div class="dtp-value">
                    <select id="dtp-duration" style="width:400px" required>
                        <option value="1">è¨±è«¾æœŸé–“ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ãªã£ãŸæ—¥ã‹ã‚‰é–‹å§‹ã•ã‚Œã€æ¨©åˆ©è€…ã«ã‚ˆã£ã¦åˆ©ç”¨ã®çµ‚äº†ãŒæŒ‡ç¤ºã•ã‚Œã‚‹ã¾ã§ã¨ã—ã¾ã™ã€‚<br>ã¾ãŸã€æ¨©åˆ©è€…ã‹ã‚‰åˆ¥é€”æŒ‡ç¤ºãŒã‚ã‚‹å ´åˆã€å½“è©²æŒ‡ç¤ºã¯ä»–ã®å®šã‚ã«å„ªå…ˆã™ã‚‹ã‚‚ã®ã¨ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã“ã‚Œã«å¾“ã†ã‹ã€ã¾ãŸã¯åˆ©ç”¨ã‚’çµ‚äº†ã—ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚æŒ‡ç¤ºã«ã¯æœ¬åˆ©ç”¨è¦ç´„ã«é–¢ã™ã‚‹æ¡ä»¶ã®ã€è¿½åŠ ã€å¤‰æ›´ã‚‚ã—ãã¯å‰Šé™¤ã€ã¾ãŸã¯åˆ©ç”¨ã®ä¸­æ­¢ãŒå«ã¾ã‚Œã¾ã™ã€‚æ¨©åˆ©è€…ãŒã€æ¨©åˆ©è€…ã®ç®¡ç†ã™ã‚‹ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã‚„ãƒ–ãƒ­ã‚°ç­‰ã«æŒ‡ç¤ºã‚’æ²ç¤ºã—ã€åˆç†çš„ãªæ–¹æ³•ã§å‘¨çŸ¥ã—ãŸå ´åˆã‚‚åŒæ§˜ã¨ã—ã¾ã™ã€‚å¾“ã£ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã€åˆç†çš„ãªç¯„å›²å†…ã§å®šæœŸçš„ã«æ¨©åˆ©è€…ã®ç™ºä¿¡ã™ã‚‹æƒ…å ±ã‚’ç¢ºèªã—ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚</option>
                        <option value="2">è¨±è«¾æœŸé–“ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ãªã£ãŸæ—¥ã‹ã‚‰é–‹å§‹ã•ã‚Œã€æœŸé–“ã®å®šã‚ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚æ¨©åˆ©è€…ãŒã€æ¨©åˆ©è€…ã®ç®¡ç†ã™ã‚‹ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã‚„ãƒ–ãƒ­ã‚°ç­‰ã«æœ¬åˆ©ç”¨è¦ç´„ã«é–¢ã™ã‚‹æ¡ä»¶ã®å¤‰æ›´ï¼ˆè¿½åŠ ã€å¤‰æ›´ã¾ãŸã¯å‰Šé™¤ã‚’å«ã¿ã¾ã™ãŒã“ã‚Œã«é™ã‚‰ã‚Œã¾ã›ã‚“ï¼‰ã‚’æ²ç¤ºã—åˆç†çš„ãªæ–¹æ³•ã§å‘¨çŸ¥ã—ãŸå ´åˆã«ãŠã„ã¦ã€ãã®åŠ¹åŠ›ç™ºç”Ÿæ—¥ä»¥é™ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæœ¬ãƒ‡ãƒ¼ã‚¿ã‚’åˆ©ç”¨ã—ãŸå ´åˆã¯ã€å½“è©²å¤‰æ›´ã«åŒæ„ã—ãŸã‚‚ã®ã¨ã¿ãªã—ã¾ã™ã€‚å¾“ã£ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã€åˆç†çš„ãªç¯„å›²å†…ã§å®šæœŸçš„ã«æ¨©åˆ©è€…ã®ç™ºä¿¡ã™ã‚‹æƒ…å ±ã‚’ç¢ºèªã—ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚</option>
                        <option value="3">è¨±è«¾æœŸé–“ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ãªã£ãŸæ—¥ã‹ã‚‰é–‹å§‹ã•ã‚Œã€æœŸé–“ã®å®šã‚ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚æœ¬è¨±è«¾ã¾ãŸã¯æœ¬åˆ©ç”¨è¦ç´„ã¯æœ¬ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ã«ã¯é©ç”¨ã•ã‚Œã¾ã›ã‚“ã€‚ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—å¾Œã®ãƒ‡ãƒ¼ã‚¿ã«ã¯ã€æ–°ãŸãªåˆ©ç”¨è¦ç´„ãŒé©ç”¨ã•ã‚Œã¾ã™ã€‚</option>
                    </select>
                    <div class="dtp-value" id="durationtextarea"></div>
                </div>

            </p>
            <p>
                <div class="settingtext">è¦ç´„ãƒãƒ¼ã‚¸ãƒ§ãƒ³</div><input type="text" class="dtp-value" id="dtp-version">
            </p>
            <p style="text-align: right;margin-right:30px">
                <span class="reqtext">*</span>ã¯å¿…é ˆé …ç›®
            </p>
            </form>
        </div>
        <textarea id="termstextarea" cols="120" rows="15" wrap="off" readonly></textarea>
        <p style="text-align: center">
            <button class="btn btn--green btn--cubic" id="textdownload">ãƒ†ã‚­ã‚¹ãƒˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
        </p>
    </div>
    <div id="termsimagepanel" class="">
        <p>
            <canvas id="downloadcanvas" width="600px" height="400px">
            </canvas>
        </p>
        <p style="text-align: center">
            <button class="btn btn--green btn--cubic" id="imagedownload">ç”»åƒã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
        </p>
    </div>
    <div id="footer">
        <span>VN3License Easy Generator created by <a href="https://twitter.com/lowteq_vr">@lowteq_vr</a></span>
        <span><a href="privacy.html">Privacy Policy & Site Policy</a></span>
    </div>

<script type="text/javascript">
    

        var termTemplate = '<p class="term">\
            <div class="lcs_wrap"><input type="checkbox" name="check-1" value="{term_index}" class="lcs_check" autocomplete="off">\
                <div class="lcs_switch lcs_checkbox_switch lcs_off">\
                    <div class="lcs_cursor"></div>\
                    <div class="lcs_label lcs_label_on">{term_on}</div>\
                    <div class="lcs_label lcs_label_off">{term_off}</div>\
                </div>\
            </div>\
                <div class="term-image"><img src="{term_imageurl}"></div>\
                <div class="term-text">{term_text}</div>\
        </p>';



        const license_version = "0.10";
        const generator_version = "1.0.0";

        var licenseTemplate = "";


    //termDataListã®åˆæœŸåŒ–ï¼ˆON OFFã®æƒ…å ±ã‚’æŒã¤ï¼‰
    var termDataList = {};
    for (var i=0;i<terms.length;i++){
        termDataList[terms[i][0]] = false;
    }

    //ã‚¢ã‚¤ã‚³ãƒ³ã¯äº‹å‰ã«ãƒ­ãƒ¼ãƒ‰ã—ã¦ãŠãã€‚drawImageã®ç›´å‰ã§ãƒ­ãƒ¼ãƒ‰ã ã¨æç”»ã•ã‚Œãªã„ã“ã¨ãŒã‚ã‚‹
    var icons = {};
    for (var i=0;i<terms.length;i++){
        var uid = terms[i][0];
        icons[uid] = new Image();
        var iconname = terms[i][4]; 
        icons[uid].src = "icons/" + iconname;
    }
    var logo = new Image();

    function termObj(indexchar){
        for (var i=0;i<temrs.length;i++){
            if(terms[i][0] == indexchar){
                return terms[i];
            }
        }
        return null;
    }

    function generateImage(){

        console.log("generateImage");

        var imagewidth = parseInt($("#imagewidth").text());
        var col = parseInt($("#columnnum").text());
        var row = 1;
        const margin = 18;
        const logoheight = 96;
        const logowidth = 240;
        const versionheight = 15;


        var onNum = 0;
        Object.keys(termDataList).forEach(function(key){
            if(termDataList[key])onNum++;
        });
        if (onNum == 0){
            row = 1;
        }else{
            row = Math.floor((onNum - 1)/ col)+1;
        }
        console.log("onNum="+ onNum + " " + col + " " + row);
        var canvas = document.getElementById('downloadcanvas');

        var iconsize = (imagewidth - 2*margin)/col;
        var iconheader = iconsize / 4;
        var imageheight = logoheight + (iconsize + iconheader) * row + margin + margin;
        
        canvas.width = imagewidth;
        canvas.height = imageheight;

        var ctx = canvas.getContext('2d');

        //backgroundæç”»
        ctx.fillStyle = "rgb(0,0,0)";
        ctx.fillRect(0, 0, imagewidth,imageheight);

        //logoæç”»
        ctx.drawImage(logo,0,0);

        //icon iconindexchar æç”»
        ctx.fillStyle = "rgb(255,255,255)";

        var pasteX = margin;
        var pasteY = logoheight + iconheader + margin;
        ctx.font = iconheader + "px Arial";
        Object.keys(termDataList).forEach(function(key){
            if(termDataList[key]){
                ctx.drawImage(icons[key], pasteX, pasteY,iconsize,iconsize);
                ctx.fillText(key,pasteX+0.5*iconsize-0.5*iconheader,pasteY-2);
                pasteX += iconsize;
                if(pasteX > imagewidth-iconsize){
                    pasteX = margin;
                    pasteY += iconsize+iconheader;
                }
            }
        });

        //versionæç”»
        ctx.font = versionheight + "px Arial";
        ctx.fillText("VN3License version:" + license_version, logowidth+margin,versionheight);
    }
    function generateText(){
        var licenseText = licenseTemplate;

        var title = $("#dtp-title").val();
        var author_name = $("#dtp-author_name").val();
        var data_name = $("#dtp-data_name").val();
        var genterms = generateTerms();
        var special_notes = $("#dtp-special_notes").val();
        var author_info = "æ¨©åˆ©è€…:" + author_name + "\n" + "å•ã„åˆã‚ã›å…ˆ:" + $("#dtp-author_reference").val() + "\n" + "ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆ:" + $("#dtp-author_website").val();
        var credit = $("#dtp-credit").val();
        var hashtag = $("#dtp-hashtag").val();
        var duration = $("#durationtextarea").text();
        var version = $("#dtp-version").val();



        licenseText = replaceAll(licenseText,"{title}",title);
        licenseText = replaceAll(licenseText,"{author_name}",author_name);
        licenseText = replaceAll(licenseText,"{data_name}",data_name);
        licenseText = replaceAll(licenseText,"{terms}",genterms);
        licenseText = replaceAll(licenseText,"{special_notes}",special_notes);
        licenseText = replaceAll(licenseText,"{author_info}",author_info);
        licenseText = replaceAll(licenseText,"{credit}",credit);
        licenseText = replaceAll(licenseText,"{hashtag}",hashtag);
        licenseText = replaceAll(licenseText,"{duration}",duration);
        licenseText = replaceAll(licenseText,"{version}",version);

        $("#termstextarea").val(licenseText);

    }

    function generateTerms() {
        
        var textterms = "";

        for(var i = 0; i < terms.length; i++) {
            
            var indexChar = terms[i][0];
            var termtext = terms[i][1];
            var selected = termDataList[indexChar]? terms[i][2] : terms[i][3];

            var addterm = "    " + indexChar + "." + termtext + " \n        " + selected + "\n";
            textterms += addterm;

        }

        return textterms;
    }

    function sendData(){


        var dataobj = objectDeepCopy(termDataList);

        var jsondata = JSON.stringify(dataobj);

        $.post({
            url:"https://script.google.com/macros/s/AKfycbytXzsdOSSUOQhSm6dDmtXxsAh4JQK_uGm7Rprp25GdI3uGsR88/exec",
            crossDomain: true,
            data:jsondata,
            dataType:"text",
        });

    };

    $(document).ready(function (e) {
        $('input.lcs_check').lc_switch();
        
        $("#durationtextarea").text($("option:selected", this).text());
        $("#vn3licenseversion").text(" v" + license_version + " ");

        $.get("https://lowteq.github.io/vn3-easy-generator/licensetemplate.txt",function(data){
            licenseTemplate = data;
            generateText();
        });

        //ONOFFæ¡é …ãƒ†ã‚­ã‚¹ãƒˆã®DOMã‚’ä½œæˆã—ã¦HTMLã«è¿½åŠ ã™ã‚‹
        for(let i = 0;i<terms.length;i++) {

            var termHTML = termTemplate;
            
            var termIndex = terms[i][0];
            var termText = termIndex + ". " +  terms[i][1];
            var termOnText = terms[i][2];
            var termOffText = terms[i][3];
            var termImageURL = "icons/" + terms[i][4];

            termHTML = termHTML.replace("{term_index}",termIndex);
            termHTML = termHTML.replace("{term_text}",termText);
            termHTML = termHTML.replace("{term_on}",termOnText);
            termHTML = termHTML.replace("{term_off}",termOffText);
            termHTML = termHTML.replace("{term_imageurl}",termImageURL);

            $("#maincontents").append(termHTML);
        }
        logo.src = "logo.png";
        logo.onload = function(){
            generateImage();
        }
        // triggered each time a field changes status
        $(document).on('lcs-statuschange', '.lcs_check', function () {

            //termã®ONOFFã®æ›´æ–°ã‚’termDataListã«åæ˜ ã™ã‚‹
            termDataList[$(this).val()] = $(this).is(":checked");

            generateImage();
            generateText();
        });

        //å…¥åŠ›é …ç›®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒ†ã‚­ã‚¹ãƒˆã‚’æ›´æ–°
        $(".dtp-value").keyup(function(){
            generateText();
        });

        //image settings ç”»åƒå¹…
        $("#imagewidthslider").on("input",function(){
            $("#imagewidth").text($(this).val());
            generateImage();
        });
        //image settings ã‚«ãƒ©ãƒ æ•°
        $("#columnslider").on("input",function(){
            $("#columnnum").text($(this).val());
            generateImage();
        });
        //image settings ãƒ”ãƒ³ã©ã‚
        $("#setting-pin").change(function(){
            var checked = $(this).is(":checked");
            if(checked){
                $("#termsimagepanel").css("position", "sticky");
            }else{
                $("#termsimagepanel").css("position","relative");
            }
        });
        $("#setting").hide();
        $("#settingbutton").on("click",function(){
            console.log("click");
            $("#setting").toggle();
        });
        $(document).on("click",function(e){
            if (!$(e.target).closest('#menu').length) {
                $('#setting').hide();
            }
        });
        $("#imagedownload").on("click",function(){
            console.log("image download");
            sendData();
            var canvas = document.getElementById("downloadcanvas");
            var link = document.createElement("a");

            var filename = "license_image.png";

            if (canvas.msToBlob) {
                var blob = canvas.msToBlob();
                window.navigator.msSaveBlob(blob, filename);
            }else{
                link.href = canvas.toDataURL("image/png");
                link.download = filename;
                link.click();
            }

        });
        $("#textdownload").on("click",function(){
            console.log("text download");
            
            if(!$("#textform").get(0).reportValidity()) return;


            var licenseText = $("#termstextarea").val();
            var blob = new Blob([licenseText]);
            var link = document.createElement("a");
            link.href = URL.createObjectURL(blob);
            link.download = "license.txt";
            link.click();

        });

        $("#dtp-duration").change(function(){
            $("#durationtextarea").text($("option:selected",this).text());
            generateText();

        });


    });


</script>

</body>

</html>